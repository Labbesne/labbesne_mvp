<% carton.manifest_for_order(order).each do |item| %>
  <tr class="stock-item" data-item-quantity="<%= item.quantity %>" style="<%= Track.find_by(spree_line_item_id: item.line_item.id).vendor_sent ? "background-color: rgba(50,250,50,0.4)" : ""; %>">
    <button class=" btn btn-success admin_mark_shipped" data-i="<%= item.line_item.id %>" style="border: none; background: transparent; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 10px auto;"><i class="fa fa-check-circle" style="width: 100%; height: 100%; font-size: 2.5rem; color: rgba(50,250,50,1);"></i></button></td>
    <td class="item-image">
      <%= render 'spree/admin/shared/image',
        image: (item.variant.gallery.images.first || item.variant.product.gallery.images.first),
        size: :mini %>
    </td>
    <td class="item-name">
      <%= link_to item.variant.product.name, edit_admin_product_path(item.variant.product) %><br><%= "(" + variant_options(item.variant) + ")" unless item.variant.option_values.empty? %>
      <% if item.variant.sku.present? %>
        <strong><%= Spree::Variant.human_attribute_name(:sku) %>:</strong>
        <%= item.variant.sku %>
      <% end %>
    </td>
    <td class="item-price"><%= item.line_item.single_money.to_html %></td>
    <td class="item-qty-show">
        <% item.states.each do |state,count| %>
          <%= count %> x <%= t(state, scope: 'spree.inventory_states') %>
        <% end %>
    </td>
    <td class="item-total"><%= line_item_shipment_price(item.line_item, item.quantity) %></td>
  </tr>
<% end %>
<script>
  $('.admin_mark_shipped').click(function(){
    req = "/shop/admin/orders/order_picked?i=" + $(this).data("i")
    $.post(req, function(){
      location.reload();
    })
  })
</script>
